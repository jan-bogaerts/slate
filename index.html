
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Library Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;c--arduino&quot;,&quot;c--mbed&quot;,&quot;python--python&quot;,&quot;python--micro&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="c--arduino">arduino</a>
              <a href="#" data-language-name="c--mbed">mbed</a>
              <a href="#" data-language-name="python--python">python</a>
              <a href="#" data-language-name="python--micro">micro-python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="introduction">Introduction</a>
          </li>
          <li>
            <a href="#key-features" class="toc-h1 toc-link" data-title="key-features">key features</a>
          </li>
          <li>
            <a href="#getting-started" class="toc-h1 toc-link" data-title="getting-started">getting started</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#installation" class="toc-h2 toc-link" data-title="installation">installation</a>
                  </li>
                  <li>
                    <a href="#usage" class="toc-h2 toc-link" data-title="usage">usage</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#details" class="toc-h1 toc-link" data-title="details">details</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#object-oriented-class-structure" class="toc-h2 toc-link" data-title="object-oriented-class-structure">object oriented: class structure</a>
                  </li>
                  <li>
                    <a href="#names-and-units" class="toc-h2 toc-link" data-title="names-and-units">names and units</a>
                  </li>
                  <li>
                    <a href="#associating-records-with-a-document" class="toc-h2 toc-link" data-title="associating-records-with-a-document">associating records with a document</a>
                  </li>
                  <li>
                    <a href="#gateways" class="toc-h2 toc-link" data-title="gateways">gateways</a>
                  </li>
                  <li>
                    <a href="#rendering" class="toc-h2 toc-link" data-title="rendering">Rendering</a>
                  </li>
                  <li>
                    <a href="#parsing" class="toc-h2 toc-link" data-title="parsing">Parsing</a>
                  </li>
                  <li>
                    <a href="#implementing-your-own-record-types" class="toc-h2 toc-link" data-title="a-name-customrecordtypes-a-implementing-your-own-record-types"><a name="customRecordTypes"></a> implementing your own record types</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#examples" class="toc-h1 toc-link" data-title="examples">examples</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#basic" class="toc-h2 toc-link" data-title="basic">basic</a>
                  </li>
                  <li>
                    <a href="#cbor-support" class="toc-h2 toc-link" data-title="cbor-support">Cbor support</a>
                  </li>
                  <li>
                    <a href="#statically-declared-actuators" class="toc-h2 toc-link" data-title="statically-declared-actuators">Statically declared actuators</a>
                  </li>
                  <li>
                    <a href="#dynamically-declared-actuators" class="toc-h2 toc-link" data-title="dynamically-declared-actuators">Dynamically declared actuators</a>
                  </li>
                  <li>
                    <a href="#custom-record" class="toc-h2 toc-link" data-title="custom-record">Custom record</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#api-documentation" class="toc-h1 toc-link" data-title="api-documentation">api documentation</a>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the KPN SenML API documentation! You can use our library for the creation of <a href="https://tools.ietf.org/html/draft-ietf-core-senml-13">senml documents</a> on embedded devices so you can transport and/or recieve data in a uniform way to and from devices using a communication protocol of your choice.</p>
<h1 id='key-features'>key features</h1>
<blockquote class="lang-specific python--python python--micro">
<p>Note: The python versions do not provide extended support for memory restricted devices</p>
</blockquote>

<ul>
<li>Object oriented design. </li>
<li>built in support for <a href="https://tools.ietf.org/html/draft-ietf-core-senml-12#section-12.1">senml&#39;s unit registry</a> </li>
<li>extendible for new data types</li>
<li>makes use of (but doesn&#39;t restrict to) KPN&#39;s predefined list of record names.</li>
<li>direct support to read/write in json and cbor format.</li>
<li>automatically adjusts record values with respect to base time, base value &amp; base sum.</li>
<li>The C++ version of the library is optimized for devices with restricted memory requirements (runs on AVR systems with 2kb ram). </li>
</ul>
<h1 id='getting-started'>getting started</h1><h2 id='installation'>installation</h2>
<blockquote class="lang-specific c--arduino">
<p>Get it from <a href="http://www.github.com">github</a> </p>
</blockquote>

<blockquote class="lang-specific c--mbed">
<p>You can import it directly from within the mbed online editor. Search for the library senml-kpn</p>
</blockquote>

<blockquote class="lang-specific python--python">
  <p>Install using the pip command: 
    <code>pip intall senmlkpn</code>
  </p>
</blockquote>

<blockquote class="lang-specific python--micro">
  <p>Get it from <a href="http://www.github.com">github</a> </p>
</blockquote>

<blockquote class="lang-specific python--micro">
  <p>Your project directory should look like this:
  <ul> 
  <li>boot.py</li>
  <li>main.py</li>
  <li>lib
    <ul>
      <li>cbor_decoder.py</li>
      <li>cbor_encoder.py</li>
      <li>senml_kpn_names.py</li>
      <li>senml_pack.py</li>
      <li>senml_record.py</li>
      <li>senml_unit.py</li>
    </ul>
  </li>
  </ul>  
  </p>
</blockquote>  

<ul>
<li>Get the library. You can find the language appropiate link to the right.</li>
<li>Installation:

<ul>
<li><em>arduino</em>: 

<ul>
<li>Follow <a href="https://www.arduino.cc/en/Guide/Libraries">these instructions</a> to install the library in the arduino ide.</li>
</ul></li>
<li>mbed: on the mbed online editor:

<ul>
<li>create or open a project</li>
<li>right click on the project and select &#39;import library/from import wizard&#39;</li>
<li>search for senml-kpn</li>
<li>double click on the search result which will start the import process.</li>
</ul></li>
<li>python: use pip to install the library<br></li>
<li>micropython:

<ul>
<li>download the library </li>
<li>extract the content of the zip file and put the library files (don&#39;t need the examples in your own project) in the &#39;lib&#39; directory of your project.</li>
</ul></li>
</ul></li>
</ul>
<h2 id='usage'>usage</h2><pre class="highlight c tab-c--arduino"><code><span class="cp">#include &lt;kpn_senml.h&gt;
</span></code></pre><pre class="highlight c tab-c--mbed"><code><span class="cp">#include &lt;kpn_senml.h&gt;
</span></code></pre><pre class="highlight python tab-python--micro"><code><span class="kn">from</span> <span class="nn">kpn_senml</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre><pre class="highlight python tab-python--python"><code><span class="kn">from</span> <span class="nn">kpn_senml</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre>
<ul>
<li>First off, you need to include the library in your sketch or application. So put the example code (in the right side panel) somewhere near the top of your source. </li>
</ul>
<pre class="highlight c tab-c--arduino"><code><span class="n">SenMLPack</span> <span class="n">doc</span><span class="p">(</span><span class="s">"device_name"</span><span class="p">);</span>
</code></pre><pre class="highlight c tab-c--mbed"><code><span class="n">SenMLPack</span> <span class="n">doc</span><span class="p">(</span><span class="s">"device_name"</span><span class="p">);</span>
</code></pre><pre class="highlight python tab-python--micro"><code><span class="n">doc</span> <span class="o">=</span> <span class="n">SenmlPack</span><span class="p">(</span><span class="s">"device_name"</span><span class="p">)</span>
</code></pre><pre class="highlight python tab-python--python"><code><span class="n">doc</span> <span class="o">=</span> <span class="n">SenmlPack</span><span class="p">(</span><span class="s">"device_name"</span><span class="p">)</span>
</code></pre>
<ul>
<li>Next, you have to declare a variable of type &#39;SenMLPack&#39;, which will function as the document that contains all your measurement values.  This can be a global or local to a function.</li>
</ul>
<pre class="highlight c tab-c--arduino"><code><span class="kt">void</span> <span class="n">loop</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">A1</span><span class="p">);</span>  
    <span class="n">SenMLFloatRecord</span> <span class="n">rec</span><span class="p">(</span><span class="n">KPN_SENML_TEMPERATURE</span><span class="p">,</span> <span class="n">SENML_UNIT_DEGREES_CELSIUS</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
    <span class="n">doc</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rec</span><span class="p">);</span>                      
<span class="p">}</span>
</code></pre><pre class="highlight c tab-c--mbed"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// check mypin object is initialized and connected to a pin
</span>    <span class="k">if</span><span class="p">(</span><span class="n">mypin</span><span class="p">.</span><span class="n">is_connected</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"mypin is connected and initialized! </span><span class="se">\n\r</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">mypin</span><span class="p">.</span><span class="n">mode</span><span class="p">(</span><span class="n">PullNone</span><span class="p">);</span>     
    <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">val</span> <span class="o">=</span> <span class="n">mypin</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>
        <span class="n">SenMLFloatRecord</span> <span class="n">rec</span><span class="p">(</span><span class="n">KPN_SENML_TEMPERATURE</span><span class="p">,</span> <span class="n">SENML_UNIT_DEGREES_CELSIUS</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
        <span class="n">doc</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rec</span><span class="p">);</span>                      
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight python tab-python--micro"><code><span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">SenmlRecord</span><span class="p">(</span><span class="n">SenmlNames</span><span class="o">.</span><span class="n">KPN_SENML_TEMPERATURE</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">SenmlUnits</span><span class="o">.</span><span class="n">SENML_UNIT_DEGREES_CELSIUS</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">23.5</span><span class="p">)</span> <span class="k">as</span> <span class="n">rec</span><span class="p">:</span>         
        <span class="n">doc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
</code></pre><pre class="highlight python tab-python--python"><code><span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">SenmlRecord</span><span class="p">(</span><span class="n">SenmlNames</span><span class="o">.</span><span class="n">KPN_SENML_TEMPERATURE</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">SenmlUnits</span><span class="o">.</span><span class="n">SENML_UNIT_DEGREES_CELSIUS</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">23.5</span><span class="p">)</span> <span class="k">as</span> <span class="n">rec</span><span class="p">:</span>         
        <span class="n">doc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
</code></pre>
<ul>
<li>Measurement values are added to the document through objects of the type SenMlRecord (for C++ versions this will be one of it&#39;s descendants). These can also be global, statically declared objects or they can be local to a function. These always need to have a value or sum, but sually you also give records a name and measurement unit. The library contains a set of predefined values for both. Although you are free to pick any record name that you want, this is not the case for the units. This list is fixed.</li>
</ul>
<pre class="highlight c tab-c--arduino"><code>    <span class="n">doc</span><span class="p">.</span><span class="n">toJson</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Serial</span><span class="p">);</span>        <span class="c1">//print to screen
</span></code></pre><pre class="highlight c tab-c--mbed"><code>        <span class="n">Serial</span> <span class="n">pc</span><span class="p">(</span><span class="n">USBTX</span><span class="p">,</span> <span class="n">USBRX</span><span class="p">);</span>
        <span class="n">doc</span><span class="p">.</span><span class="n">toJson</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pc</span><span class="p">);</span>        <span class="c1">//print to screen
</span>        <span class="n">pc</span><span class="p">.</span><span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n\r</span><span class="s">"</span><span class="p">);</span>
</code></pre><pre class="highlight python tab-python--micro"><code>        <span class="k">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
</code></pre><pre class="highlight python tab-python--python"><code>        <span class="k">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
</code></pre>
<ul>
<li>finally, you can render the senml json string and print it out. In C++, this can be either to a stream or you can render it to a memory buffer. Python always renders to memory.</li>
</ul>

<p>The resulting code snippet reads the value, stores this measument in a senml record as temperature in degrees celsius and adds this record to the document. Finally, the document object renders a json string to the Serial output, or for python, just prints it to the screen.<br>
At the end of the function, the record is destroyed cause it goes out of scope. This will automatically remove it from the document, so on the next run, the document will be empty again and a new record can be added.  </p>

<p>For more examples, see <a href="#examples">here</a></p>
<h1 id='details'>details</h1><h2 id='object-oriented-class-structure'>object oriented: class structure</h2><h3 id='c'>C++</h3>
<p><img src="images/library_design.png" alt="class diagram" /><br>
The root class for all senml documents is called &#39;SenMlPack&#39;.  It defines the base name, base unit and base time of the document.  This object can also contain 0, 1 or more SenMlRecords where each record represents a single measurement (or command for actuators).<br>
In order to declare a base value or base sum, you have to use one of SenMLPack&#39;s descendents with the correct data type.<br>
The library contains a pre-defined SenMlRecord class for the most common data types: string, boolean, float, integer and binary. But, you can extend this with your own types through the SenMLRecord template for basic data types such as longlong or double. And, if you want to go even deeper, you can extend the SenMLRecord base class, which can be useful for creating records that have multiple values like coordinates. See <a href="#customRecordTypes">here</a> for more info.  </p>
<h3 id='python'>python</h3>
<p><img src="images/library_design_python.png" alt="class diagram" /> 
As you can see, the python version of the library is much simpler compared to the C++ version. This is primarily due to the fact that python automatically resolves data types, so there is no need for complex class structures.<br>
The library&#39;s setup is very similar to the C++ version: Use a SenMLPack record to represent senml documents. Measurements or actuator commands are declared with SenMLRecords.</p>
<h2 id='names-and-units'>names and units</h2>
<p>The library defines an enum for all of senml&#39;s supported measurement units (as in &#39;kilogram&#39;, &#39;meter&#39;,...). This makes it easier to keep compliance with the <a href="https://tools.ietf.org/html/draft-ietf-core-senml-13">senml specifications</a> as you don&#39;t have to worry about the exact unit symbols: the library takes care of this.<br>
Similarly, the library also provides an enum (or set of #defines in C++) with all the record names that the KPN network supports.<br>
Although it is possible that you assign your own name to a record, it is recommended to use KPN&#39;s naming convention as this allows data to be addressed in a more semantical manner.<br>
Both parameters are supplied through the constructor of the SenMlRecords.<br>
According to the SenML specifications, all names are optional, so you don&#39;t have to declare a base name on the SenMLPack object nor a name for SenMLRecords.  This makes it harder though to identify your data. In general, it is advisable to specify the name of the device as the base name and the name of the sensor as the record name. Alternatively, you can skip the base name and put both device and sensor name in the record, in this format: <code>device:sensor</code>.</p>
<h2 id='associating-records-with-a-document'>associating records with a document</h2><pre class="highlight c tab-c--arduino"><code><span class="n">SenMLFloatRecord</span> <span class="n">rec</span><span class="p">(</span><span class="n">KPN_SENML_TEMPERATURE</span><span class="p">,</span> <span class="n">SENML_UNIT_DEGREES_CELSIUS</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
<span class="n">doc</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rec</span><span class="p">);</span>                      
</code></pre><pre class="highlight c tab-c--mbed"><code><span class="n">SenMLFloatRecord</span> <span class="n">rec</span><span class="p">(</span><span class="n">KPN_SENML_TEMPERATURE</span><span class="p">,</span> <span class="n">SENML_UNIT_DEGREES_CELSIUS</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
<span class="n">doc</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rec</span><span class="p">);</span>                      
</code></pre><pre class="highlight python tab-python--micro"><code><span class="n">SenmlRecord</span><span class="p">(</span><span class="n">SenmlNames</span><span class="o">.</span><span class="n">KPN_SENML_TEMPERATURE</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">SenmlUnits</span><span class="o">.</span><span class="n">SENML_UNIT_DEGREES_CELSIUS</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">23.5</span><span class="p">)</span>         
<span class="n">doc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
</code></pre><pre class="highlight python tab-python--python"><code><span class="n">SenmlRecord</span><span class="p">(</span><span class="n">SenmlNames</span><span class="o">.</span><span class="n">KPN_SENML_TEMPERATURE</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">SenmlUnits</span><span class="o">.</span><span class="n">SENML_UNIT_DEGREES_CELSIUS</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">23.5</span><span class="p">)</span>         
<span class="n">doc</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
</code></pre>
<p>You can add records to the document with the function <code>add</code>. This can be done statically (add once at startup and never remove) for devices that will always send out the same document structure with the same records. Or, you can dynamically add records to the document as your application progresses. A common use case for this method is for situations where the device does not have network connectivity at the moment that the measurement is taken, but instead, takes a number of measurements, and, when a connection is available, uploads all the measurements at once.  This method is useful to minimize the number of communication packets that a device uses by grouping measurements.  </p>
<pre class="highlight c tab-c--arduino"><code><span class="n">doc</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>                      
</code></pre><pre class="highlight c tab-c--mbed"><code><span class="n">doc</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>                        
</code></pre><pre class="highlight python tab-python--micro"><code><span class="n">doc</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre><pre class="highlight python tab-python--python"><code><span class="n">doc</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre>
<p>For documents that work with a dynamically sized list of records, you can <a href="#clear">clear</a> out the list once the data has been sent.<br>
Alternatively ,when SenMlRecords go out of scope or are deleted, they remove themselves automatically from their root document.<br>
Internally, the C++ version uses a linked list to store the records that it manages. This helps in minimizing the usage of dynamically allocated memory (important for devices with little available ram).<br>
The python versions use standard python arrays to store the data.</p>
<h2 id='gateways'>gateways</h2>
<p>It is possible to transmit/receive SenMLPack objects that contain other SenMLPack objects. This is used by gateways that work as an intermediate for devices that don&#39;t have a direct connection with the outside world or which can&#39;t speak senml and need a device that performs a translation between the protocol that they understand and senml.<br>
Creating such messages is pretty strait forward, just like you add SenMLRecords to a Pack, you can also add SenMLPack objects. This works for sensor values that need to be sent out and for actuators.</p>
<h2 id='rendering'>Rendering</h2><h2 id='parsing'>Parsing</h2><h2 id='implementing-your-own-record-types'><a name="customRecordTypes"></a> implementing your own record types</h2>
<p>It is possible to create your own, custom SenMlRecord classes. This can be used to provide support for more complex data types than already available in the library.  For instance, if you would like to store location info (lat/lng/alt) in a single record instead of 3 individual ones, than you could create a new class that inherits from the SenMlRecord template, provide a struct as template parameter and re-implement the rendering and parsing functions.<br>
You can find an example <a href="#custom-record">here</a>.</p>
<h1 id='examples'>examples</h1><h2 id='basic'>basic</h2><pre class="highlight plaintext"><code>#include &lt;kpnSenml.h&gt;

SenMlPack doc("device_name");

void init(){

}

void loop(){
    int val = analogRead(A1);  
    SenMlNumericRecord senmlVal(SENML_TEMPERATURE, SENML_CELSIUS, val);
    doc.add(senmlVal);                      
    doc.toJson(Serial);
}
</code></pre><h2 id='cbor-support'>Cbor support</h2><pre class="highlight plaintext"><code>#include &lt;kpnSenml.h&gt;

SenMlPack doc("device_name");

void init(){

}

void loop(){
    int val = analogRead(A1);  
    SenMlNumericRecord senmlVal(SENML_TEMPERATURE, SENML_CELSIUS, val);
    doc.add(senmlVal);                      
    doc.toCbor(Serial);
}
</code></pre><h2 id='statically-declared-actuators'>Statically declared actuators</h2><pre class="highlight plaintext"><code>#include &lt;kpnSenml.h&gt;

void onSwitch(bool value){
    digitalWrite(D1, value);
}


SenMlPack doc("device_name");
SenMlBoolRecord senmlVal(SENML_SWITCH, onSwitch);

void init(){
    doc.add(senmlVal);
}

void loop(){
    if(Serial.available()){
        if(doc.fromJson(Serial)){
            Serial.print("end");
        }
    }
}
</code></pre><h2 id='dynamically-declared-actuators'>Dynamically declared actuators</h2><pre class="highlight plaintext"><code>#include &lt;kpnSenml.h&gt;

void onSwitch(bool value){
    digitalWrite(D1, value);
}

void onOtherSenMl(const char* name, const char* unit, BYTE dataType, void* value){
    Serial.print("found unknown record in input: "); Serial.println(name);
}

SenMlPack doc("device_name", onOtherSenMl);
SenMlBoolRecord senmlVal(SENML_SWITCH, onSwitch);

void init(){
    doc.add(senmlVal);
}

void loop(){
    if(Serial.available()){
        if(doc.fromCbor(Serial)){
            Serial.print("end");
        }
    }
}
</code></pre><h2 id='custom-record'>Custom record</h2><h1 id='api-documentation'>api documentation</h1>
<p>If you are building up a senml message than it&#39;s best that to specify the base name of the senml document in order to declare the name of the device. Other parameters can be:
- the base unit
- a callback function used to relay actuator commands found during parsing of a senml message.  </p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="c--arduino">arduino</a>
                <a href="#" data-language-name="c--mbed">mbed</a>
                <a href="#" data-language-name="python--python">python</a>
                <a href="#" data-language-name="python--micro">micro-python</a>
          </div>
      </div>
    </div>
  </body>
</html>
